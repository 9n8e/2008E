bool __cdecl RBX::Security::Context::isInRole(
        RBX::Security::Identities identity,
        RBX::Security::Permissions permission)
{
  bool result; // al

  switch ( identity )
  {
    case Anonymous:
    case GameScript:
      result = permission == None;
      break;
    case LocalGUI:
    case CmdLine:
      if ( (unsigned int)permission < 2 )
        goto LABEL_5;
      result = 0;
      break;
    case TrustedCOM:
    case TrustedWebService:
      result = 1;
      break;
    case Replicator:
      if ( permission == None || permission == 3 )
LABEL_5:
        result = 1;
      else
        result = 0;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}
